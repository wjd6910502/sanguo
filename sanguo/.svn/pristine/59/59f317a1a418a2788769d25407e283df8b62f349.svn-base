
#include "statusserver.hpp"
#include "state.hxx"
#include "serverstatus.hpp"
#include "glog.h"

namespace GNET
{

StatusServer StatusServer::instance;

unsigned char text_utf8[] = {
  0xe6, 0xb8, 0xb8, 0xe6, 0x88, 0x8f, 0xe6, 0x9c, 0x8d, 0xe5, 0x8a, 0xa1,
  0xe5, 0x99, 0xa8, 0xe6, 0xad, 0xa3, 0xe5, 0x9c, 0xa8, 0xe7, 0xbb, 0xb4,
  0xe6, 0x8a, 0xa4, 0xe4, 0xb8, 0xad, 0xef, 0xbc, 0x8c, 0xe8, 0xaf, 0xb7,
  0xe7, 0xa8, 0x8d, 0xe5, 0x90, 0x8e, 0xe5, 0x86, 0x8d, 0xe6, 0x9d, 0xa5,
  0xe3, 0x80, 0x82, 0x0a
};
unsigned int text_utf8_len = 52;

const Protocol::Manager::Session::State* StatusServer::GetInitState() const
{
	return &state_StatusServer;
}

void StatusServer::OnAddSession(Session::ID sid)
{
	GLog::log(LOG_INFO, "StatusServer::OnAddSession, sid=%u", sid);
	
	ServerStatus prot;
	prot.info = Octets(text_utf8, text_utf8_len);
	Send(sid, prot);
}

void StatusServer::OnDelSession(Session::ID sid)
{
	GLog::log(LOG_INFO, "StatusServer::OnDelSession, sid=%u", sid);
}

};
